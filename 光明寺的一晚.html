<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æœ€å¾Œçš„å‚™å¿˜éŒ„ - å°ç£äººæ°‘è§£æ”¾é™£ç·šçµ•ç­†</title>
    <style>
        :root {
            --bg-color: #0f0f13;
            --text-color: #c0c0c0;
            --accent-color: #a83f39; /* æš—ç´…è‰²ï¼Œè±¡å¾µé¦™ç«èˆ‡è¡€ */
            --highlight-color: #e0e0e0;
            --font-main: "Noto Serif TC", "Songti TC", serif;
            --font-mono: "Courier New", Courier, monospace;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: var(--font-main);
            line-height: 1.8;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            min-height: 100vh;
        }

        .container {
            width: 100%;
            max-width: 800px;
            padding: 40px 20px;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        header {
            border-bottom: 1px solid #333;
            margin-bottom: 40px;
            padding-bottom: 20px;
            text-align: center;
        }

        h1 {
            font-size: 1.5rem;
            letter-spacing: 3px;
            color: var(--accent-color);
            margin: 0;
            font-weight: normal;
        }

        .meta-info {
            font-size: 1.1rem;
            color: #e0e0e0;
            margin-top: 15px;
            font-family: var(--font-mono);
            letter-spacing: 1px;
            font-weight: bold;
            border-top: 1px solid #333;
            padding-top: 10px;
            display: inline-block;
        }

        /* éŠæˆ²ä¸»è¦–åœ–å€åŸŸ */
        #game-view {
            display: block; /* é è¨­é¡¯ç¤º */
            animation: fadeIn 0.5s ease-in;
        }

        .scene-text {
            font-size: 1.1rem;
            margin-bottom: 30px;
            white-space: pre-wrap;
            animation: fadeIn 1.5s ease-in;
        }

        .highlight {
            color: var(--accent-color);
            font-weight: bold;
        }

        .choices {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: auto;
            border-top: 1px solid #333;
            padding-top: 30px;
        }

        button {
            background: transparent;
            border: 1px solid #444;
            color: var(--text-color);
            padding: 15px 20px;
            text-align: left;
            cursor: pointer;
            font-family: var(--font-main);
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        button:hover {
            border-color: var(--accent-color);
            background-color: rgba(168, 63, 57, 0.1);
            color: var(--highlight-color);
        }

        button:disabled {
            border-color: #222;
            color: #444;
            cursor: not-allowed;
            opacity: 0.5;
        }

        #controls {
            margin-top: 20px;
            padding-top: 10px;
            display: flex;
            justify-content: flex-start;
        }

        #back-btn {
            font-size: 0.9rem;
            padding: 8px 15px;
            border: 1px dashed #555;
            color: #777;
        }
        
        #back-btn:hover:not(:disabled) {
            border-color: var(--text-color);
            color: var(--text-color);
            background-color: transparent;
        }

        /* æ›¸ç±ä»‹ç´¹è§¸ç™¼æŒ‰éˆ•æ¨£å¼ */
        #book-trigger-area {
            margin-top: 50px;
            text-align: center;
            display: none; /* é è¨­éš±è—ï¼Œç”± JS æ§åˆ¶ */
            animation: fadeIn 1s ease-in;
        }

        .promo-btn {
            background: rgba(26, 26, 32, 0.8);
            border: 1px solid var(--accent-color);
            color: var(--accent-color);
            padding: 12px 25px;
            font-family: var(--font-main);
            cursor: pointer;
            font-size: 1.1rem;
            transition: all 0.3s;
            text-align: center;
            letter-spacing: 1px;
            display: inline-block;
        }
        .promo-btn:hover {
            background: var(--accent-color);
            color: #fff;
            box-shadow: 0 0 15px rgba(168, 63, 57, 0.5);
        }

        /* æ›¸ç±ä»‹ç´¹é é¢æ¨£å¼ (ç¨ç«‹è¦–åœ–) */
        #book-page-view {
            display: none; /* é è¨­éš±è— */
            animation: fadeIn 0.5s ease-in;
            margin-top: 0;
            padding-top: 20px;
        }

        .book-content {
            border: 1px solid #333;
            background-color: #1a1a20;
            padding: 40px;
            display: flex;
            gap: 40px;
            align-items: flex-start;
            border-radius: 4px;
            margin-bottom: 30px;
        }

        .book-cover {
            flex-shrink: 0;
        }

        .book-cover img {
            width: 200px;
            height: auto;
            box-shadow: 0 4px 20px rgba(0,0,0,0.6);
            border: 1px solid #555;
        }

        .book-info {
            flex: 1;
        }

        .book-info h3 {
            color: var(--highlight-color);
            margin-top: 0;
            margin-bottom: 20px;
            font-size: 1.4rem;
            border-bottom: 2px solid var(--accent-color);
            padding-bottom: 10px;
            display: inline-block;
        }

        .book-info p {
            font-size: 1rem;
            color: #ccc;
            line-height: 1.8;
            margin: 0;
            text-align: justify;
        }

        .book-controls {
            text-align: center;
        }

        .return-btn {
            background: transparent;
            border: 1px solid #555;
            color: #aaa;
            padding: 10px 30px;
            font-size: 1rem;
            cursor: pointer;
            display: inline-block;
            text-align: center;
        }

        .return-btn:hover {
            border-color: var(--text-color);
            color: var(--text-color);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* æ‰‹æ©Ÿé©é… */
        @media (max-width: 600px) {
            .container { padding: 20px; }
            h1 { font-size: 1.2rem; }
            .scene-text { font-size: 1rem; }
            
            .book-content {
                flex-direction: column;
                align-items: center;
                padding: 20px;
                gap: 20px;
            }
            .book-cover img {
                width: 140px;
            }
            .book-info h3 {
                font-size: 1.2rem;
                display: block;
                text-align: center;
            }
        }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>æª”æ¡ˆç·¨è™Ÿï¼šTPLF-202X-FINAL</h1>
        <p class="meta-info">åœ°é»ï¼šæ–°åŒ—å¸‚çŸ³ç¢‡å±±å€å…‰æ˜å¯º | æ™‚é–“ï¼šæˆ°çˆ­æœ«æœŸ</p>
    </header>

    <!-- éŠæˆ²ä¸»è¦è¦–åœ– -->
    <div id="game-view">
        <div id="game-content">
            <div id="scene-text" class="scene-text"></div>
            <div id="choices" class="choices"></div>
            <div id="controls">
                <button id="back-btn" onclick="navigateBack()" disabled>â† å›ä¸Šä¸€é </button>
            </div>
        </div>

        <!-- æ›¸ç±ä»‹ç´¹è§¸ç™¼æŒ‰éˆ•å€ (çµå±€æ™‚é¡¯ç¤º) -->
        <div id="book-trigger-area">
            <button class="promo-btn" onclick="showBookPage()">ğŸ“– é—œæ–¼åŸè‘—å°èªªã€Šä»¥ä¸‹è­‰è¨€å°‡è¢«å…¨é¢å¦èªã€‹</button>
        </div>
    </div>

    <!-- æ›¸ç±ä»‹ç´¹ç¨ç«‹é é¢ (é è¨­éš±è—) -->
    <div id="book-page-view">
        <div class="book-content">
            <div class="book-cover">
                <!-- 
                     æ³¨æ„ï¼šè«‹ç¢ºä¿åœ–ç‰‡æª”æ¡ˆåç¨±ç‚ºã€Œä»¥ä¸‹è­‰è¨€å°‡è¢«å…¨é¢å¦èª.jpegã€ï¼Œ
                     ä¸¦ä¸”èˆ‡æ­¤ HTML æª”æ¡ˆä½æ–¼åŒä¸€å€‹è³‡æ–™å¤¾ä¸­ã€‚
                -->
                <img src="ä»¥ä¸‹è­‰è¨€å°‡è¢«å…¨é¢å¦èª.jpeg" alt="ã€Šä»¥ä¸‹è­‰è¨€å°‡è¢«å…¨é¢å¦èªã€‹æ›¸ç±å°é¢" onerror="this.style.display='none'; this.parentElement.innerHTML='[æ›¸ç±å°é¢åœ–ç‰‡]';">
            </div>
            <div class="book-info">
                <h3>åŸè‘—å°èªªï¼šã€Šä»¥ä¸‹è­‰è¨€å°‡è¢«å…¨é¢å¦èªã€‹</h3>
                <p>
                    ã€Šä»¥ä¸‹è­‰è¨€å°‡è¢«å…¨é¢å¦èªã€‹ç”±äº”ç¯‡åœç¹è‘—å°æµ·æˆ°çˆ­ä¸»é¡Œçš„å°èªªæ§‹æˆï¼šåœ¨ä¸å¤ªé™é çš„æœªä¾†ï¼ŒäºŒã€‡å››ä¸ƒå¹´ï¼Œä¸­åœ‹å› ç‚ºå…§éƒ¨å› ç´ ï¼ŒçŒç„¶ç™¼å‹•å°å°æˆ°çˆ­ã€‚ä¸€ä½é•·å¹´é—œæ³¨æˆ°çˆ­è¨˜æ†¶çš„ä½œå®¶ï¼Œåœ¨æˆ°å¾ŒäºŒåå¹´ä¹‹éš›ï¼Œæœ‰æ„Ÿæ–¼åŒå„•é›–ç„¶éƒ½åœ¨é’å°‘å¹´æ™‚æœŸç¶“æ­·äº†æˆ°äº‹ï¼Œä½†æ¯å€‹äººçš„è¨˜æ†¶å»éƒ½ä¸ä¸€æ¨£ï¼Œæ–¼æ˜¯é–‹å§‹æ¡è¨ªä¸åŒçš„è¦‹è­‰è€…ã€‚ä»–åœ¨æ¡è¨ªéç¨‹ä¸­ç™¼ç¾æœ‰ä¸å°‘åœ¨å®˜æ–¹èªªæ³•å¤–çš„æˆ°çˆ­æ¨£è²Œï¼Œæ¥è§¸åˆ°è¨±å¤šæª¯é¢ä¸Šä¸å¯è¦‹çš„æ­·å²è³‡æ–™ï¼Œå› è€Œå¯«æˆäº†çµ•å°æœƒè¢«å®˜æ–¹å¦èªçš„æˆ°æ™‚æ•…äº‹ã€‚
                </p>
            </div>
        </div>
        <div class="book-controls">
            <button class="return-btn" onclick="hideBookPage()">â† è¿”å›éŠæˆ²çµå°¾</button>
        </div>
    </div>

</div>

<script>
    // éŠæˆ²æ•¸æ“šåº«
    const storyData = {
        start: {
            text: `æ­¤åˆ»çš„æˆ‘å€‘ï¼Œåœ¨è’é™¬çš„å¯ºè£¡ç‡ƒèµ·äº†æœ€å¾Œä¸€ç›’é¦™ç‡­ã€‚
æ»¿å®¤ä»¤äººæšˆçœ©çš„é¦¨é¦™ï¼Œçƒˆå£«ç‰Œä½çš„å½±å­æ‰“åœ¨æˆ‘å€‘çš„ç´™é¢ä¸Šã€‚
ä»–å€‘çš„è…³æ­¥è¶Šä¾†è¶Šè¿‘äº†ï¼Œè»é´çš„è²éŸ³ï¼Œæ§æ¢°è·Ÿæˆ°è¡“èƒŒå¿ƒæ‘©æ“¦çš„è²éŸ³...
æˆ‘å€‘å¹¾ä¹ä¸€ç„¡æ‰€æ‡¼ï¼Œæˆ‘å€‘åªå®³æ€•æ™‚é–“ä¸å¤ ï¼Œä¸å¤ ç”¢ä¸‹æˆ‘æ–¹çš„æ­·å²ã€‚

æˆ‘æ˜¯é‚£æ²’æœ‰åˆ†é…åˆ°æ§æï¼Œå»åˆ†é…åˆ°ç´™ç­†çš„äººã€‚
åœ¨é€™æœ€å¾Œçš„æ™‚åˆ»ï¼Œæˆ‘è©²å¾ä½•è™•è½ç­†ï¼Ÿ`,
            choices: [
                { text: "å¾é˜¿æ˜çš„ç•«é–‹å§‹ï¼šé‚£ç¬¬ä¸€æšå°å½ˆè½ä¸‹çš„ç‹‚å–œã€‚", next: "ah_ming" },
                { text: "å¾çµ•æœ›çš„ç¾å¯¦é–‹å§‹ï¼šå›æƒ³é‚£å€‹è©²æ­»çš„ã€Œå››ç¶­äº‹ä»¶ã€ã€‚", next: "si_wei" },
                { text: "çœ‹è‘—çœ¼å‰çš„ç‰Œä½ï¼šæƒ³èµ·å¼µæ¾ç‚èˆ‡é»ƒæ­£æ°‘çš„çŠ§ç‰²ã€‚", next: "martyrs" }
            ]
        },
        ah_ming: {
            text: `æˆ‘æƒ³èµ·äº†ä¹æ­²çš„é˜¿æ˜ã€‚
å¾ç¥–åœ‹çš„ç¬¬ä¸€æšå°å½ˆè½åœ¨å°ç£å³¶ä¸Šæ™‚ï¼Œæ­·å²å°±é–‹å§‹æ‰­æ›²äº†ã€‚
é˜¿æ˜ç•«ä¸‹äº†é‚£ä¸€å¹•â€”â€”å°å½ˆå¦‚é•·é‡åˆºå…¥æ·¡æ°´æ²³é‚Šï¼ŒåœŸåœ°çŒ¶å¦‚çš®è†šçŒ›çƒˆç—™æ”£ã€‚

ã€Œä¸­åœ‹äººä¸æ‰“ä¸­åœ‹äººï¼Œæ‰€ä»¥æˆ‘å€‘å®¶é€£ä¸€ç‰‡çª—æˆ¶éƒ½æ²’æœ‰ç ´ã€‚ã€é‚£å­©å­ç•¶æ™‚æ˜¯é€™éº¼èªªçš„ã€‚
é‚£æ˜¯ä¸€æ¬¡å‰å¤§çš„ã€Œä½¯æ”»ã€ã€‚æˆ‘å€‘ç•¶æ™‚å¤šéº¼å …ä¿¡ï¼Œé€™æ˜¯ç™¾å¹´çµ±ä¸€çš„ç¬¬ä¸€å€‹éŸ³ç¬¦ã€‚

ä½†ç¾åœ¨ï¼Œé˜¿æ˜åœ¨å“ªè£¡ï¼Ÿ`,
            choices: [
                { text: "ä»–åœ¨å—æ¸¯å±±å€æœæ•‘é£›è¡Œå“¡æ™‚å´©æ½°äº†ã€‚", next: "pilot_search" },
                { text: "ä»–åœ¨æ—é‚Šï¼Œçœ¼ç¥ç©ºæ´åœ°çœ‹è‘—ä½›åƒã€‚", next: "temple_state" }
            ]
        },
        si_wei: {
            text: `æˆ‘ä¸é¡˜å»æƒ³ï¼Œä½†ä¸å¾—ä¸æƒ³ã€‚é‚£å€‹è®“å±€å‹¢é€†è½‰çš„é—œéµâ€”â€”é«˜é›„çš„ã€Œå››ç¶­äº‹ä»¶ã€ã€‚
è¶™æ€å¢¨ä¸Šå°‡ï¼Œé‚£å€‹æˆ‘å€‘ä»¥ç‚ºæœƒè¢«ä¿˜è™œçš„äººï¼Œç«Ÿç„¶åæ®ºäº†æ‰“ç®—æŠ•èª çš„ç¸£å¸‚é•·ã€‚

é‚£æ˜¯ç¬¬ä¸€å¼µå€’ä¸‹çš„éª¨ç‰Œã€‚æ¥è‘—æ˜¯ã€Œæ¿æ°´ç´šã€æ½›è‰¦çš„ã€Œè©æ­»ã€...
åŸä¾†æ•´å€‹æµ·å³½æš¢è¡Œç„¡é˜»çš„ç™»é™¸ï¼Œåªæ˜¯å°è»ç‚ºäº†èª˜æ•µæ·±å…¥è¨­ä¸‹çš„é™·é˜±ã€‚
ä¸‰åè¬å¤§è»ï¼Œæ²’å½ˆæ²’ç³§ï¼Œæˆäº†é€™ä¸€ä»£äººæœ€æ…˜ç—›çš„äººè³ªã€‚`,
            choices: [
                { text: "é€™æ˜¯å‡çš„ï¼é€™ä¸€å®šæ˜¯å°ç¨ä»½å­çš„å‡è¨Šæ¯ï¼", next: "denial" },
                { text: "é™³å¡—å±±å¸¶ä¾†äº†æ–°èå½±åƒï¼Œæˆ‘å€‘ä¸å¾—ä¸ä¿¡ã€‚", next: "news_arrival" }
            ]
        },
        martyrs: {
            text: `å¼µæ¾ç‚å¤«å©¦è¢«æ›åœ¨è·¯ç‡ˆä¸Šï¼Œé„°å±…æ¼ ç„¶èµ°éã€‚
é»ƒæ­£æ°‘åœ¨å°åŒ—è»Šç«™æŠ±è‘—ç‚¸å½ˆï¼ŒæŠŠè‡ªå·±çš„è¡€è‚‰ç‚¸æˆäº†ä¸€æ¢è·¯ã€‚

æˆ‘å€‘æ›¾ç¶“æœ‰ä¸‰åä¸ƒäººï¼Œç¾åœ¨åªå‰©ä¸‹é€™äº›æ®˜å…µæ•—å°‡ï¼Œèº²åœ¨é€™å€‹å«åšã€Œå…‰æ˜å¯ºã€çš„åœ°æ–¹ã€‚
é€™è£¡çš„å°è¯å¯«è‘—ï¼šã€Œå…‰è€€å¤ä»Šä¸ç”Ÿä¸æ»…...ã€
å¤šéº¼è«·åˆºï¼Œæˆ‘å€‘å³å°‡æ¯€æ»…ï¼Œè€Œæ­·å²å°‡ç”±å‹åˆ©è€…æ›¸å¯«ã€‚`,
            choices: [
                { text: "å›åˆ°ç¾å¯¦ï¼Œé™³å¡—å±±é€²ä¾†äº†ï¼Œè‡‰è‰²éµé’ã€‚", next: "news_arrival" }
            ]
        },
        pilot_search: {
            text: `é‚£æ˜¯ä¸€æ®µåœ°ç„èˆ¬çš„è¨˜æ†¶ã€‚
ç‚ºäº†æœæ•‘å½ˆå°„çš„é£›è¡Œå“¡ï¼Œæˆ‘å€‘åœ¨å±±å€æ‰¾åˆ°äº†åå››å…·å±é«”ã€‚
æ¯ä¸€å…·éƒ½æ˜¯æˆ‘å€‘çš„é£›è¡Œå“¡ã€‚

é˜¿æ˜å’¬è‘—è‡ªå·±çš„æ‰‹è‡‚ï¼Œå“­å–Šè‘—è¦æŠŠæ‰‹çµ¦é‚£æ¢å¼è‘—æ®˜è‚¢çš„é‡ç‹—ã€‚
é‚„æœ‰é‚£å€‹å€–å­˜çš„æ±ªç«‹ä¸Šå°‰ï¼Œä»–åœ¨ç™¼é«˜ç‡’æ™‚çš„å¤¢å›ˆ...
ã€Œè¡›æ˜Ÿ...æ˜Ÿæ˜Ÿ...æ˜¯è¡›æ˜Ÿç‡’å£äº†è¿´è·¯...ã€

å¦‚æœé€£å¤©ä¸Šçš„è¡›æ˜Ÿéƒ½è¼¸äº†ï¼Œæˆ‘å€‘é‚„å‰©ä¸‹ä»€éº¼ï¼Ÿ`,
            choices: [
                { text: "ä¸å†å»æƒ³ï¼Œå°ˆæ³¨æ–¼ç•¶ä¸‹çš„å›°å¢ƒã€‚", next: "temple_state" }
            ]
        },
        temple_state: {
            text: `å…‰æ˜å¯ºçš„æ­£æ®¿ç´ æ·¨ç©ºé—Šã€‚
æˆ‘å€‘æŠŠé€™è£¡ç•¶ä½œæœ€å¾Œçš„åŸºåœ°ã€‚é™³æ°ç¥–æ¯â€”â€”é‚£ä½ä¹åå¤šæ­²çš„è€äººï¼Œé»˜é»˜åœ°æ”¯æŒè‘—æˆ‘å€‘ã€‚
å¥¹èªªï¼šã€Œå¥½å¥½å¹¹ï¼Œä¸å¿…è¬ã€‚ã€

ä½†ç¾åœ¨ï¼Œå±±ä¸‹çš„é¢¨è²è®Šäº†ã€‚é™³å¡—å±±èªªï¼Œæ‘æ°‘å€‘é–‹å§‹ç›¸ä¿¡å°è»åæ”»äº†ã€‚
ä»–å€‘ç›¸ä¿¡æˆ‘å€‘è¼¸äº†ã€‚
é‡é»ä¸æ˜¯çœŸç›¸ï¼Œé‡é»æ˜¯ã€Œä»–å€‘ç›¸ä¿¡ã€ã€‚`,
            choices: [
                { text: "æ‘æ°‘æœƒå‡ºè³£æˆ‘å€‘ã€‚", next: "betrayal_fear" }
            ]
        },
        news_arrival: {
            text: `é™³å¡—å±±ç«™åœ¨å¤§æ®¿é–€å£ï¼Œè²éŸ³é¡«æŠ–ã€‚
ã€Œä»–å€‘èªªï¼Œå°è»å¦å…‹å·²ç¶“é–‹åˆ°æµ·é‚Šäº†...ã€
ã€Œæ‘æ°‘å€‘éƒ½åœ¨å‚³ï¼Œæ¿æ°´ç´šæ²’æ²‰ï¼Œé‚£æ˜¯åœˆå¥—...ã€

ææ‡¼åƒç—…æ¯’ä¸€æ¨£è”“å»¶ã€‚å¦‚æœæ‘æ°‘ç›¸ä¿¡ç¥–åœ‹æˆ°æ•—äº†ï¼Œé‚£ä»–å€‘çœ‹æˆ‘å€‘çš„çœ¼ç¥å°±æœƒæ”¹è®Šã€‚
åŸæœ¬çš„ã€Œç¾©å£«ã€ï¼Œå°‡è®Šæˆã€Œæˆ°çŠ¯ã€ã€‚`,
            choices: [
                { text: "æˆ‘å€‘å¿…é ˆå…ˆä¸‹æ‰‹ç‚ºå¼·ã€‚", next: "the_plan" },
                { text: "æˆ‘å€‘åªèƒ½æ‰“è‡ªå·±æ‰“å¾—èµ·çš„ä»—ã€‚", next: "the_plan" }
            ]
        },
        denial: {
            text: `æˆ‘åœ¨ç´™ä¸Šæ†¤æ€’åœ°å¯«ä¸‹ï¼šé€™ä¸€åˆ‡éƒ½æ˜¯è¬Šè¨€ï¼
å¯æ˜¯...ç‚ºä»€éº¼é€£é€™è£¡éƒ½èƒ½è½åˆ°é æ–¹çš„çˆ†ç‚¸è²ï¼Ÿç‚ºä»€éº¼æ²’æœ‰å¢æ´ï¼Ÿ
ç‚ºä»€éº¼æ±ªç«‹ä¸Šå°‰æ­»å‰æœƒèªªé‚£äº›è©±ï¼Ÿ

æ‰¿èªå§ã€‚ç„¡è«–çœŸå‡ï¼Œæˆ‘å€‘éƒ½è¢«æ‹‹æ£„åœ¨é€™åº§å­¤å³¶ä¸Šäº†ã€‚`,
            choices: [
                { text: "åªèƒ½é¢å°ç¾å¯¦ã€‚", next: "news_arrival" }
            ]
        },
        betrayal_fear: {
            text: `ææ‡¼åœ¨æˆ‘å€‘çœ¼ä¸­å‚³éã€‚
é™³å¡—å±±è¢«æˆ‘å€‘åš‡é€€äº†ä¸€æ­¥ã€‚
ã€Œæˆ‘å€‘ç¾åœ¨è¦æ€éº¼è¾¦ï¼Ÿã€ä»–å•ã€‚

æˆ‘çœ‹è‘—æ®¿å…§çš„ä½›åƒï¼Œå¿ƒä¸­å‡èµ·ä¸€å€‹æœ€å¾Œçš„è¨ˆåŠƒã€‚
é€™ä¸æ˜¯ç‚ºäº†ç”Ÿå­˜ï¼Œæ˜¯ç‚ºäº†å°Šåš´ï¼Œæˆ–è€…...ç˜‹ç‹‚ã€‚`,
            choices: [
                { text: "ã€Œæˆ‘å€‘è¦è«‹å®¢åƒé£¯ã€‚ã€", next: "the_plan" }
            ]
        },
        the_plan: {
            text: `ã€Œå‘Šè¨´æ‘æ°‘ï¼Œæˆ°çˆ­çµæŸäº†ã€‚æˆ‘å€‘è¼¸äº†ï¼Œè¦æŠ•é™ã€‚ã€æˆ‘å¹³éœåœ°èªªã€‚
ã€Œä½†åœ¨é‚£ä¹‹å‰ï¼Œæˆ‘å€‘è¦å®´è«‹å…¨æ‘ï¼ŒæŠŠæ‰€æœ‰çš„ç½é ­ã€é…’éƒ½æ‹¿å‡ºä¾†ã€‚ã€

é€™æ˜¯ä¸€å ´æœ€å¾Œçš„æ™šé¤ã€‚
æˆ‘å€‘è¦è®“ä»–å€‘æ”¾ä¸‹æˆ’å¿ƒï¼Œç„¶å¾Œ...

æˆ‘å€‘ç„¡è¦–ä½›å¯ºçš„æˆ’è¦ï¼Œå¤§å£åƒè‚‰ï¼Œå¤§å£å–é…’ã€‚
æ‘æ°‘å€‘é†‰äº†ï¼Œç¬‘è‘—è«‡è«–ç¥–åœ‹çš„å¤±æ•—ï¼Œç¬‘è‘—è«‡è«–æˆ‘å€‘çš„æœ«è·¯ã€‚`,
            choices: [
                { text: "è½è‘—ä»–å€‘çš„ç¬‘è²ï¼Œå¿ƒä¸­çš„æ®ºæ„æ¼¸èµ·ã€‚", next: "interrogation" },
                { text: "çŒé†‰ä»–å€‘ï¼Œç„¶å¾Œé–ä¸Šå¤§é–€ã€‚", next: "lock_up" }
            ]
        },
        lock_up: {
            text: `é…’æ•ˆç™¼ä½œï¼Œæ‘æ°‘å€‘æ­ªå€’ä¸€ç‰‡ã€‚
æˆ‘å€‘å‹•æ‰‹äº†ã€‚
ç¶ä½æ‰‹è…³ï¼Œè‹¥æœ‰æŠµæŠ—å°±ç”¨éˆç‰©æ‰“æšˆã€‚
å³ä½¿æ˜¯é™³å¡—å±±ï¼Œä¹Ÿè¢«æˆ‘å€‘ä¸€æ£æ‰“ç¿»åœ¨åœ°ï¼Œé¡è§’æµè¡€ã€‚

æˆ‘å€‘é–ä¸Šæ­£æ®¿ã€‚
ç¾åœ¨ï¼Œé€™è£¡æ˜¯å¯©è¨Šå®¤äº†ã€‚`,
            choices: [
                { text: "é–‹å§‹å¯©è¨Šï¼šæ‰¾å‡ºæ˜¯èª°æ•£ä½ˆè¬ è¨€ã€‚", next: "interrogation" }
            ]
        },
        interrogation: {
            text: `éš”æ—¥æ­£åˆï¼Œå“­è²èˆ‡å’†å“®éœ‡è€³æ¬²è¾ã€‚
æˆ‘å€‘æŠŠäººæ‹–é€²è‡¨æ™‚åµè¨Šå®¤ã€‚
å•é¡Œåªæœ‰ä¸€å€‹ï¼šã€Œä½ è½èª°èªªçš„ï¼Ÿã€

ææ‡¼è®“ä»–å€‘å´©æ½°ã€‚
ã€Œå°±æ˜¯ä»–ï¼ã€
é„°å±…å‡ºè³£é„°å±…ï¼Œè¦ªäººæŒ‡èªè¦ªäººã€‚
é€™å¼µèµ¤ç…‰è›‡èˆ¬çš„äººéš›ç¶²è¦†è“‹äº†æ•´å€‹æ‘å­ã€‚
ä»–å€‘å½¼æ­¤æ’•å’¬ï¼Œç‚ºäº†çˆ­å–ä¸€é»é»æˆ‘å€‘çµ¦äºˆçš„ã€Œå¯¬æ•ã€ã€‚

åªæœ‰ä¸€å€‹äººä¾‹å¤–ã€‚`,
            choices: [
                { text: "é™³æ°ç¥–æ¯ã€‚", next: "grandma" }
            ]
        },
        grandma: {
            text: `é‚£ä½ä¹åå¤šæ­²çš„è€äººï¼Œè¢«ç¶äº†ä¸€æ•´å¤©ï¼Œå…¨èº«æƒ¡è‡­ã€‚
ä½†æ²’æœ‰ä»»ä½•æ‘æ°‘æ•¢æå¥¹çš„åå­—ã€‚
å¥¹ä¸€æ•´å¤©æ²’æœ‰ç§»å‹•ï¼Œåƒä¸€å°Šè‚‰èº«ä½›ã€‚

ç•¶æˆ‘å€‘è¦å°‡å¥¹æ‹–å‡ºå»æ™‚ï¼Œå…¨æ‘çš„äººæš´å‹•äº†ã€‚
ä»–å€‘ç”¨ç›¡æœ€å¾Œçš„åŠ›æ°£ï¼Œç”¨ç‰™é½’å’¬ä½æˆ‘å€‘çš„è…¿ï¼Œè©¦åœ–é˜»æ­¢æˆ‘å€‘ã€‚
å ´é¢å¤±æ§äº†ã€‚è¡€è…¥å‘³ï¼Œæ±—è‡­å‘³ï¼Œä»¥åŠçµ•æœ›çš„æ°£æ¯ã€‚

æˆ‘å€‘æ®èˆæ£æ£’ï¼Œæ•²æ“Šï¼Œæˆ³åˆº...
ç›´åˆ°...`,
            choices: [
                { text: "æ§è²éŸ¿èµ·ã€‚", next: "climax" }
            ]
        },
        climax: {
            text: `é æ–¹å‚³ä¾†äº†æ§è²ã€‚
è»é´çš„è²éŸ³ã€‚
æ§æ¢°è·Ÿæˆ°è¡“èƒŒå¿ƒæ‘©æ“¦çš„è²éŸ³ã€‚

èƒ½è½è¦‹ï¼Œå°±ä¸ç®—å¤ªé äº†ã€‚
æœˆå…‰æ‰“é€²å…‰æ˜å¯ºï¼Œç…§äº®äº†æ®¿å…§æ©«é™³çš„èº«é«”ã€‚

é€™æ™‚ï¼Œæ²‰é»˜å·²ä¹…çš„é™³æ°ç¥–æ¯é–‹å£äº†ã€‚
å¥¹ç”¨ä¸€ç¨®å¹¾ä¹å·²è¢«éºå¿˜çš„æº«æŸ”ï¼Œçœ‹è‘—æˆ‘å€‘ã€‚`,
            choices: [
                { text: "è½å¥¹æœ€å¾Œä¸€å¥è©±ã€‚", next: "ending" }
            ]
        },
        ending: {
            text: `ã€Œå¾ˆä¹…å¾ˆä¹…ä»¥å‰ï¼Œæˆ‘å°±è¦‹éä½ å€‘äº†ã€‚ã€å¥¹èªªã€‚

é€™å¥è©±æ˜¯ä»€éº¼æ„æ€ï¼Ÿ
æ˜¯èªªå¥¹è¦‹éæ­·å²çš„è¼ªè¿´ï¼Ÿé‚„æ˜¯çœ‹é€äº†æˆ‘å€‘é€™äº›ç‹‚ç†±è€…çš„æœ¬è³ªï¼Ÿ

æ²’æ™‚é–“äº†ã€‚
éšŠå“¡å€‘æ‹¿è‘—åƒ…æœ‰çš„å¹¾æŠŠæ§è¡å‡ºå»äº†ã€‚
è€Œæˆ‘ï¼Œæˆ‘æ˜¯é‚£åˆ†é…åˆ°è¨˜æ†¶çš„äººã€‚

æˆ‘åœ¨é€™è£¡å¯«ä¸‹æœ€å¾Œä¸€å€‹å­—ã€‚
ç¥–åœ‹å•Šç¥–åœ‹ï¼Œä½ æ˜¯æˆ‘å€‘é™£ç—›è€Œé‚„æ²’ç”¢ä¸‹çš„é‚£æ®µæ­·å²ã€‚
ç¾åœ¨ï¼Œæˆ‘ä¹Ÿå°‡æ‰“å®Œè‡ªå·±çš„æœ€å¾Œä¸€ç™¼å½ˆè—¥â€”â€”æˆ‘çš„ç­†ã€‚

<span class="highlight">--- è¨Šè™Ÿä¸­æ–· ---</span>`,
            choices: [
                { text: "é‡æ–°é–±è®€æª”æ¡ˆ", next: "start" }
            ]
        }
    };

    // éŠæˆ²å¼•æ“ç‹€æ…‹
    const sceneTextEl = document.getElementById('scene-text');
    const choicesEl = document.getElementById('choices');
    const backBtn = document.getElementById('back-btn');
    const bookTrigger = document.getElementById('book-trigger-area');
    const gameView = document.getElementById('game-view');
    const bookPageView = document.getElementById('book-page-view');
    
    let historyStack = [];
    let currentSceneKey = 'start';

    function renderScene(sceneKey) {
        const scene = storyData[sceneKey];
        currentSceneKey = sceneKey;
        
        // æ·¡å…¥æ•ˆæœ
        sceneTextEl.style.animation = 'none';
        sceneTextEl.offsetHeight; /* trigger reflow */
        sceneTextEl.style.animation = 'fadeIn 1s ease-in';
        
        sceneTextEl.innerHTML = scene.text.replace(/\n/g, '<br>');
        
        // ç”Ÿæˆé¸é …
        choicesEl.innerHTML = '';
        scene.choices.forEach(choice => {
            const btn = document.createElement('button');
            btn.innerText = `> ${choice.text}`;
            btn.onclick = () => {
                navigateTo(choice.next);
            };
            choicesEl.appendChild(btn);
        });

        // è™•ç†æ›¸ç±ä»‹ç´¹æŒ‰éˆ•çš„é¡¯ç¤ºé‚è¼¯
        handleBookTriggerVisibility(sceneKey);

        // æ›´æ–°æŒ‰éˆ•ç‹€æ…‹
        updateBackBtnState();
    }

    function handleBookTriggerVisibility(sceneKey) {
        // åªæœ‰åœ¨çµå±€æ™‚é¡¯ç¤ºæŒ‰éˆ•
        if (sceneKey === 'ending') {
            bookTrigger.style.display = 'block';
        } else {
            bookTrigger.style.display = 'none';
        }
    }

    // é¡¯ç¤ºæ›¸ç±é é¢ï¼ˆéš±è—éŠæˆ²è¦–åœ–ï¼‰
    function showBookPage() {
        gameView.style.display = 'none';
        bookPageView.style.display = 'block';
        // æ»¾å‹•åˆ°é ‚éƒ¨
        window.scrollTo(0, 0);
    }

    // éš±è—æ›¸ç±é é¢ï¼ˆè¿”å›éŠæˆ²è¦–åœ–ï¼‰
    function hideBookPage() {
        bookPageView.style.display = 'none';
        gameView.style.display = 'block';
    }

    function navigateTo(nextKey) {
        // å¦‚æœæ˜¯å›åˆ°èµ·é»ï¼ˆé‡æ–°é–‹å§‹ï¼‰ï¼Œå‰‡æ¸…ç©ºæ­·å²ç´€éŒ„
        if (nextKey === 'start') {
            historyStack = [];
        } else {
            // å°‡ç•¶å‰å ´æ™¯æ¨å…¥æ­·å²å †ç–Š
            historyStack.push(currentSceneKey);
        }
        renderScene(nextKey);
    }

    function navigateBack() {
        if (historyStack.length === 0) return;
        
        // å–å‡ºä¸Šä¸€å€‹å ´æ™¯
        const prevKey = historyStack.pop();
        renderScene(prevKey);
    }

    function updateBackBtnState() {
        backBtn.disabled = historyStack.length === 0;
    }

    // åˆå§‹åŒ–
    renderScene('start');

</script>

</body>
</html>